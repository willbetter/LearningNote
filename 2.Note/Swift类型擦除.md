> 如果我们在定义的协议中使用到了`Self`或者`associateType`, 那么我们不能使用此协议约束变量. 因为如果想要约束一个变量, 那么我们必须知道这个变量的具体类型和大小, 但是Self和AssociateType对我们来说都是未知的, 我们无法推测它是什么类型. 

在真实的项目开发中, 很多时候我们需要使用协议来约束类型. 实际上我们可以使用类型擦除技术来实现这个目的. 我们定义一个类型来实现协议, 在类型的实现中通过泛型来约束具体类型, 在这个类型初始化过程中, 注入具体的实现类型, 此类型内部的实现只是对函数调用的转发. 这样我们可以通过具体的类型来约束变量了. 

**创建擦除类型的步骤:**

1. **创建一个名为 Any 的封装**（*因为当我们在执行类型擦除的时候，这是我们实际需要操作的类型*）。在 Swift 标准库当中，您会看到一个名为 `AnySequence` 的协议。它就是序列协议当中的一个典型的类型擦除示例（*我们可将其视作类型擦除的最佳实践*)。
2. 确保您的类型擦除类型是**泛型**，因为比起抽象类型以及协议中的 `associatedtype` 来说，编译器处理泛型更加得心应手。
3. 让这个类型**实现**此泛型协议。
4. 将任何遵守该协议的初始实例**注入**到这个类当中。
5. 将所有此协议必须要执行调用**发送**到基础类型当中——也就是发送到您刚刚注入的那个类型擦除类当中。



Swift GG的这篇译文详细的讲解了swift中的类型擦除以及类型擦除的实现. [swift 类型擦除](https://swift.gg/2018/10/11/friday-qa-2017-12-08-type-erasure-in-swift/).

如果上述连接失效可以参看这里:  [swift.gg-Swift 类型擦除.pdf](../resourse/material/swift.gg-Swift 类型擦除.pdf)